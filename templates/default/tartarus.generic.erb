# Generated by Chef for node <%= node["fqdn"] %>
# Local modifications will be overwritten.
#

STORAGE_METHOD="FTP"
STORAGE_FTP_SSL_INSECURE="<%= node['tartarus']['STORAGE_FTP_SSL_INSECURE'] %>"
STORAGE_FTP_SERVER="<%= node['tartarus']['STORAGE_FTP_SERVER'] %>"
STORAGE_FTP_USER="<%= node['tartarus']['STORAGE_FTP_USER'] %>"
STORAGE_FTP_PASSWORD="<%= node['tartarus']['STORAGE_FTP_PASSWORD'] %>"
STORAGE_FTP_USE_SFTP="<%= node['tartarus']['STORAGE_FTP_USE_SFTP'] %>"
COMPRESSION_METHOD="<%= node['tartarus']['COMPRESSION_METHOD'] %>"
ENCRYPT_SYMMETRICALLY="<%= node['tartarus']['ENCRYPT_SYMMETRICALLY'] %>"
ENCRYPT_PASSPHRASE_FILE="<%= node['tartarus']['ENCRYPT_PASSPHRASE_FILE'] %>"
STAY_IN_FILESYSTEM="<%= node['tartarus']['STAY_IN_FILESYSTEM'] %>"

TARTARUS_PRE_PROCESS_HOOK() {
    echo -n "$STORAGE_FTP_PASSWORD" | perl /usr/sbin/charon.ftp \
    --host "$STORAGE_FTP_SERVER" \
    --user "$STORAGE_FTP_USER" --readpassword \
    --maxage 2 \
    --all
}